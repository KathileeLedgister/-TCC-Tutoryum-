var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.makeIterator=function(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,d){if(a==Array.prototype||a==Object.prototype)return a;a[b]=d.value;return a};
$jscomp.getGlobal=function(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<a.length;++b){var d=a[b];if(d&&d.Math==Math)return d}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};
$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(a,b){var d=$jscomp.propertyToPolyfillSymbol[b];if(null==d)return a[b];d=a[d];return void 0!==d?d:a[b]};$jscomp.polyfill=function(a,b,d,c){b&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(a,b,d,c):$jscomp.polyfillUnisolated(a,b,d,c))};
$jscomp.polyfillUnisolated=function(a,b,d,c){d=$jscomp.global;a=a.split(".");for(c=0;c<a.length-1;c++){var f=a[c];if(!(f in d))return;d=d[f]}a=a[a.length-1];c=d[a];b=b(c);b!=c&&null!=b&&$jscomp.defineProperty(d,a,{configurable:!0,writable:!0,value:b})};
$jscomp.polyfillIsolated=function(a,b,d,c){var f=a.split(".");a=1===f.length;c=f[0];c=!a&&c in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var e=0;e<f.length-1;e++){var g=f[e];if(!(g in c))return;c=c[g]}f=f[f.length-1];d=$jscomp.IS_SYMBOL_NATIVE&&"es6"===d?c[f]:null;b=b(d);null!=b&&(a?$jscomp.defineProperty($jscomp.polyfills,f,{configurable:!0,writable:!0,value:b}):b!==d&&(void 0===$jscomp.propertyToPolyfillSymbol[f]&&(d=1E9*Math.random()>>>0,$jscomp.propertyToPolyfillSymbol[f]=$jscomp.IS_SYMBOL_NATIVE?
$jscomp.global.Symbol(f):$jscomp.POLYFILL_PREFIX+d+"$"+f),$jscomp.defineProperty(c,$jscomp.propertyToPolyfillSymbol[f],{configurable:!0,writable:!0,value:b})))};$jscomp.underscoreProtoCanBeSet=function(){var a={a:!0},b={};try{return b.__proto__=a,b.a}catch(d){}return!1};
$jscomp.setPrototypeOf=$jscomp.TRUST_ES6_POLYFILLS&&"function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null;$jscomp.generator={};$jscomp.generator.ensureIteratorResultIsObject_=function(a){if(!(a instanceof Object))throw new TypeError("Iterator result "+a+" is not an object");};
$jscomp.generator.Context=function(){this.isRunning_=!1;this.yieldAllIterator_=null;this.yieldResult=void 0;this.nextAddress=1;this.finallyAddress_=this.catchAddress_=0;this.finallyContexts_=this.abruptCompletion_=null};$jscomp.generator.Context.prototype.start_=function(){if(this.isRunning_)throw new TypeError("Generator is already running");this.isRunning_=!0};$jscomp.generator.Context.prototype.stop_=function(){this.isRunning_=!1};
$jscomp.generator.Context.prototype.jumpToErrorHandler_=function(){this.nextAddress=this.catchAddress_||this.finallyAddress_};$jscomp.generator.Context.prototype.next_=function(a){this.yieldResult=a};$jscomp.generator.Context.prototype.throw_=function(a){this.abruptCompletion_={exception:a,isException:!0};this.jumpToErrorHandler_()};$jscomp.generator.Context.prototype["return"]=function(a){this.abruptCompletion_={"return":a};this.nextAddress=this.finallyAddress_};
$jscomp.generator.Context.prototype.jumpThroughFinallyBlocks=function(a){this.abruptCompletion_={jumpTo:a};this.nextAddress=this.finallyAddress_};$jscomp.generator.Context.prototype.yield=function(a,b){this.nextAddress=b;return{value:a}};$jscomp.generator.Context.prototype.yieldAll=function(a,b){var d=$jscomp.makeIterator(a),c=d.next();$jscomp.generator.ensureIteratorResultIsObject_(c);if(c.done)this.yieldResult=c.value,this.nextAddress=b;else return this.yieldAllIterator_=d,this.yield(c.value,b)};
$jscomp.generator.Context.prototype.jumpTo=function(a){this.nextAddress=a};$jscomp.generator.Context.prototype.jumpToEnd=function(){this.nextAddress=0};$jscomp.generator.Context.prototype.setCatchFinallyBlocks=function(a,b){this.catchAddress_=a;void 0!=b&&(this.finallyAddress_=b)};$jscomp.generator.Context.prototype.setFinallyBlock=function(a){this.catchAddress_=0;this.finallyAddress_=a||0};$jscomp.generator.Context.prototype.leaveTryBlock=function(a,b){this.nextAddress=a;this.catchAddress_=b||0};
$jscomp.generator.Context.prototype.enterCatchBlock=function(a){this.catchAddress_=a||0;a=this.abruptCompletion_.exception;this.abruptCompletion_=null;return a};$jscomp.generator.Context.prototype.enterFinallyBlock=function(a,b,d){d?this.finallyContexts_[d]=this.abruptCompletion_:this.finallyContexts_=[this.abruptCompletion_];this.catchAddress_=a||0;this.finallyAddress_=b||0};
$jscomp.generator.Context.prototype.leaveFinallyBlock=function(a,b){var d=this.finallyContexts_.splice(b||0)[0];if(d=this.abruptCompletion_=this.abruptCompletion_||d){if(d.isException)return this.jumpToErrorHandler_();void 0!=d.jumpTo&&this.finallyAddress_<d.jumpTo?(this.nextAddress=d.jumpTo,this.abruptCompletion_=null):this.nextAddress=this.finallyAddress_}else this.nextAddress=a};$jscomp.generator.Context.prototype.forIn=function(a){return new $jscomp.generator.Context.PropertyIterator(a)};
$jscomp.generator.Context.PropertyIterator=function(a){this.object_=a;this.properties_=[];for(var b in a)this.properties_.push(b);this.properties_.reverse()};$jscomp.generator.Context.PropertyIterator.prototype.getNext=function(){for(;0<this.properties_.length;){var a=this.properties_.pop();if(a in this.object_)return a}return null};$jscomp.generator.Engine_=function(a){this.context_=new $jscomp.generator.Context;this.program_=a};
$jscomp.generator.Engine_.prototype.next_=function(a){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_.next,a,this.context_.next_);this.context_.next_(a);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.return_=function(a){this.context_.start_();var b=this.context_.yieldAllIterator_;if(b)return this.yieldAllStep_("return"in b?b["return"]:function(d){return{value:d,done:!0}},a,this.context_["return"]);this.context_["return"](a);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.throw_=function(a){this.context_.start_();if(this.context_.yieldAllIterator_)return this.yieldAllStep_(this.context_.yieldAllIterator_["throw"],a,this.context_.next_);this.context_.throw_(a);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.yieldAllStep_=function(a,b,d){try{var c=a.call(this.context_.yieldAllIterator_,b);$jscomp.generator.ensureIteratorResultIsObject_(c);if(!c.done)return this.context_.stop_(),c;var f=c.value}catch(e){return this.context_.yieldAllIterator_=null,this.context_.throw_(e),this.nextStep_()}this.context_.yieldAllIterator_=null;d.call(this.context_,f);return this.nextStep_()};
$jscomp.generator.Engine_.prototype.nextStep_=function(){for(;this.context_.nextAddress;)try{var a=this.program_(this.context_);if(a)return this.context_.stop_(),{value:a.value,done:!1}}catch(b){this.context_.yieldResult=void 0,this.context_.throw_(b)}this.context_.stop_();if(this.context_.abruptCompletion_){a=this.context_.abruptCompletion_;this.context_.abruptCompletion_=null;if(a.isException)throw a.exception;return{value:a["return"],done:!0}}return{value:void 0,done:!0}};
$jscomp.generator.Generator_=function(a){this.next=function(b){return a.next_(b)};this["throw"]=function(b){return a.throw_(b)};this["return"]=function(b){return a.return_(b)};this[Symbol.iterator]=function(){return this}};$jscomp.generator.createGenerator=function(a,b){var d=new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(b));$jscomp.setPrototypeOf&&a.prototype&&$jscomp.setPrototypeOf(d,a.prototype);return d};
$jscomp.asyncExecutePromiseGenerator=function(a){function b(c){return a.next(c)}function d(c){return a["throw"](c)}return new Promise(function(c,f){function e(g){g.done?c(g.value):Promise.resolve(g.value).then(b,d).then(e,f)}e(a.next())})};$jscomp.asyncExecutePromiseGeneratorFunction=function(a){return $jscomp.asyncExecutePromiseGenerator(a())};$jscomp.asyncExecutePromiseGeneratorProgram=function(a){return $jscomp.asyncExecutePromiseGenerator(new $jscomp.generator.Generator_(new $jscomp.generator.Engine_(a)))};
var _use_css_definitions=!1,_bshutDown=!1,_b_sequence=!1,_app_f_btn_set="",_pw_handler="",_userid="",_usersession=-1,_userlevel=0,__uuid=0,_f_vTys=[0],_f_vTxs=[0],_f_eTs=[0],_f_dXTs=[0],_f_dYTs=[0],_f_t_c_back="",_b_tc=!1,_f_pre_submit=function(a,b){return Promise.reject()},_f_post_submit=function(a,b){return Promise.reject()},_f_set_pw=function(){$(document).on("click",_app_f_btn_set,function(){_g_errorModal&&$(_g_errorModal).toast("hide");"function"===typeof _pw_handler&&_pw_handler();return!1});
_app_f_btn_set=""},_f_submit=function(a,b,d){var c=document.getElementById("main-form");return(new Promise(function(f,e){$(c).removeClass("was-validated");!1===c.checkValidity()?($(c).addClass("was-validated"),e(Error("FORM_INVALID:"))):($(c).addClass("was-validated"),f())})).then(function(){var f=new FormData(c),e=$("#"+a).attr("pg_url"),g="undefined"!==typeof $("#"+a).attr("pg_get"),h=$("#"+a).attr("pg_data");h||(h="");f.append("_app_submitter",$("#"+a).attr("id"));f.has("userid")||f.append("userid",
_userid);f.append("session",b.session?b.session:_usersession);f.append("level",_userlevel);f.append("uuid",__uuid);var l="",k="";g||(l=new URLSearchParams(h));f=$jscomp.makeIterator(f.entries());for(k=f.next();!k.done;k=f.next())k=k.value,g?l+="&"+encodeURIComponent(k[0])+"="+encodeURIComponent(k[1]):l.append(k[0],k[1]);g?(g=new Headers,g.append("Accept","text/plain;text/html;application/json"),l=l.replace(/%20/g,"+"),k=new Request(e+"?"+l.substr(1)+(h?"&"+h:""),{method:"GET",mode:"same-origin",cache:"no-cache",
headers:g,credentials:"same-origin",redirect:"error",referrerPolicy:"no-referrer"})):k=new Request(e,{method:"POST",mode:"same-origin",cache:"no-cache",credentials:"same-origin",redirect:"error",referrerPolicy:"no-referrer",body:l});return fetch(k).then(function(m){if(!m.ok)throw Error("REQUEST ERROR: Unable to process your request");var n=m.headers.get("content-type");if(!n||!n.includes("application/json"))throw new TypeError("MALFORMED RESPONSE: Oops, we haven't got the correct format!");return(n=
$("#"+a).attr("pg_url_next"))?_f_goload("undefined",{pg_url:n}).then(function(){return Promise.resolve(m.json())}):Promise.resolve(m.json())})["catch"](function(m){showErrorModal(m.message);return Promise.reject(m)})})};
_submit_handler=function(a,b){if(!_b_sequence){_b_sequence=!0;var d=document.getElementById("main-form");return d?(new Promise(function(c,f){_f_pre_submit(a,b).then(function(){c()})["catch"](function(e){f(e)})})).then(function(){d.requestSubmit();return _f_submit(a,b).then(function(c){b.rpJson=c;return _f_post_submit(a,b)["finally"](function(){_b_sequence=!1})})["catch"](function(){_b_sequence=!1})})["catch"](function(c){_b_sequence=!1;return Promise.reject(c)}):(_b_sequence=!1,Promise.reject())}};
var _f_goload=function(a,b,d){var c=$("#"+a).attr("pg_url");if(!c){if("string"!==typeof b.pg_url)return d||showErrorModal("URLNOTFOUND: Unable to process request"),Promise.reject(Error("URLNOTFOUND: Unable to process request"));c=b.pg_url}var f=$("#"+a).attr("allow_scripts");a=new Headers;a.append("Content-Type","text/plain;text/html");a.append("Accept","text/html");c=new Request(c,{method:"GET",mode:"same-origin",cache:"no-cache",credentials:"same-origin",headers:a,redirect:"error",referrerPolicy:"no-referrer"});
return fetch(c).then(function(e){if(!e.ok)throw Error("REQUEST ERROR: Unable to process your request");var g=e.headers.get("content-type");if(!g||!g.includes("text/html"))throw new TypeError("MALFORMED RESPONSE: Oops, we haven't got the correct format!");return e.text()}).then(function(e){try{var g=!1,h=e;if(!_bshutDown&&null===e)h="Unknown Error";else if(_bshutDown||"string"!==typeof e||"Error:"!==e.substr(0,6))if(_bshutDown||"undefined"!==typeof e[1])g=!0,h=e;if(g){e=-1;if(-1===(e=h.indexOf("<body "))&&
-1===(e=h.indexOf("<BODY ")))throw Error("MALFORMED HTML: <body tag not found in the page ... Developer Error.");h=h.substr(e+6);if(-1===(e=h.indexOf(">")))throw Error("MALFORMED HTML: Body tag closing > expected ... Developer Error.");h=h.substr(e+1);if(-1===(e=h.lastIndexOf("</body"))&&-1===(e=h.lastIndexOf("</BODY")))throw Error("MALFORMED HTML: </body tag not found in the page ... Developer Error.");h=h.substr(0,e);try{return $("#page-content").empty(),f||(h=h.replace(/<script[ ]/gi,"<noscript ").replace(/<\/script[ ]/gi,
"</noscript ")),$("#page-content").prepend(h),f||($("#page-content noscript").addClass("suppressed-script"),_use_css_definitions||$("#page-content noscript").css({display:"none"})),_app_f_btn_set&&_f_set_pw(),Promise.resolve()}catch(l){throw $("#page-content").prepend("UNKNOWN ERROR: Error Processing Page"),Error("UNKNOWN ERROR: Error Processing Page");}}else throw Error("FEATURE NOT AVAILABLE: Error Processing Page");}catch(l){throw Error("UNKNOWN ERROR:");}})["catch"](function(e){showErrorModal(e.message);
return Promise.reject(e)})},_f_gofetch=function(a,b,d){var c=$("#"+a).attr("id"),f="string"===typeof b.pg_url?b.pg_url:c;f||("string"===typeof b.pg_url&&b.pg_url||Promise.reject(Error("URLNOTFOUND: Request NOT supported")),f=b.pg_url);(a=$("#"+a).attr("pg_data"))||(a="");a=new URLSearchParams(a);a.append("_app_submitter",c?c:"string"===typeof b.pg_id?b.pg_id:"none");a.has("userid")||a.append("userid",_userid);a.append("session",b.session?b.session:_usersession);a.append("level",_userlevel);"undefined"!==
typeof __uuid&&a.append("uuid",__uuid);c=b="";c=$jscomp.makeIterator(a.entries());for(a=c.next();!a.done;a=c.next())a=a.value,b+="&"+encodeURIComponent(a[0])+"="+encodeURIComponent(a[1]);c=new Headers;c.append("Accept","application/json");b=b.replace(/%20/g,"+");c=new Request(f+b.substr(f.endsWith("?")?1:0),{method:"GET",mode:"same-origin",cache:"no-cache",headers:c,credentials:"same-origin",redirect:"error",referrerPolicy:"no-referrer"});return fetch(c).then(function(e){if(!e.ok)throw Error("REQUEST ERROR: Unable to process your request");
var g=e.headers.get("content-type");if(!g||!g.includes("application/json"))throw new TypeError("MALFORMED RESPONSE: Oops, we haven't got the correct format!");return Promise.resolve(e.json())})["catch"](function(e){d||showErrorModal(e.message);return Promise.reject(e)})};function _set_TC_back(a){a&&!_f_t_c_back&&(window.addEventListener("touchstart",handleStart,{passive:!1}),window.addEventListener("touchmove",handleMove,{passive:!1}),_f_t_c_back=a)}
function _reset_TC_back(a){setTimeout(function(){_set_TC_back(a)},250)}function _clear_TC_back(){_f_t_c_back&&(window.removeEventListener("touchstart",handleStart,{passive:!1}),window.removeEventListener("touchmove",handleMove,{passive:!1}),_f_t_c_back="")}function handleStart(a){_f_t_c_back&&(a=a.changedTouches,_f_vTxs[0]=0,_f_vTys[0]=0,_f_eTs[0]=Date.now(),_f_dXTs[0]=a[0].pageX,_f_dYTs[0]=a[0].pageY)}
function handleMove(a){if(_f_t_c_back){a=a.changedTouches;var b=Date.now();if(0<b-_f_eTs[0]){var d=a[0].pageX-_f_dXTs[0];var c=a[0].pageY-_f_dYTs[0];d/=b-_f_eTs[0];c/=b-_f_eTs[0];_f_vTxs[0]=(20*_f_vTxs[0]+d)/21;_f_vTys[0]=(20*_f_vTys[0]+c)/21;_f_eTs[0]=b;_f_dXTs[0]=a[0].pageX;_f_dYTs[0]=a[0].pageY;if(!_b_tc){_b_tc=!0;var f=_f_vTxs[0],e=_f_vTys[0];setTimeout(function(){_f_t_c_back(f,e);_b_tc=!1},2)}}}}
function urlBase64ToUint8Array(a){var b="=".repeat((4-a.length%4)%4);a=(a+b).replace(/\-/g,"+").replace(/_/g,"/");a=window.atob(a);b=new Uint8Array(a.length);for(var d=0;d<a.length;++d)b[d]=a.charCodeAt(d);return b}
function push_subscribe(a){navigator.serviceWorker.ready.then(function(b){var d,c,f;return $jscomp.asyncExecutePromiseGeneratorProgram(function(e){if(1==e.nextAddress)return e.yield(fetch("api/vapidPublicKey",{method:"GET"}),2);if(3!=e.nextAddress)return d=e.yieldResult,e.yield(d.text(),3);c=e.yieldResult;f=urlBase64ToUint8Array(c);return e["return"](b.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:f})["catch"](function(g){showErrorModal("WARNING: Subscription Registration Failed<br>"+
g.message)}))})}).then(function(b){console.log("Subscribed",b.endpoint);return fetch("api/register",{method:"post",headers:{"Content-type":"application/json"},body:JSON.stringify({subscription:b,options:a})})}).then(setUnsubscribeButton)}
function push_unsubscribe(a){navigator.serviceWorker.ready.then(function(b){return b.pushManager.getSubscription()}).then(function(b){return b.unsubscribe().then(function(){console.log("Unsubscribed",b.endpoint);return fetch("api/unregister",{method:"post",headers:{"Content-type":"application/json"},body:JSON.stringify({subscription:b,options:a})})})}).then(setSubscribeButton)};